import{r as R,u as D,a as $,a0 as L,v as M,aA as U,j as e,G as l,a3 as G,aB as Y,aC as J,aD as K,n as A,ar as B,aq as Q,E as X,z as Z,w as V}from"./index-nP3sWgOM.js";import{F as ee,a as oe}from"./formik.esm-Dyqt8FN9.js";import{I as re}from"./ImageUpload-B33Abahr.js";import{c as te,b as ie,d as h,a as N}from"./index.esm-B2q6Cw9c.js";import{I as ae}from"./index-BYu15YCe.js";import{u as se}from"./useUser-xy9w6s-p.js";import{a as ne,I as O}from"./InputLabel-DaDe49tm.js";import{A as le}from"./Autocomplete-Cb93hnIo.js";import{T as u,S as F}from"./TextField-Btu36Zmo.js";import{M as T}from"./MenuItem-vSBr2iRT.js";import{C as me}from"./Checkbox-CVXqhyuK.js";import{B as ce}from"./Button-DYMAArme.js";import"./index-CcBqUUtn.js";import"./Close-CYbAYMXT.js";const Pe=_=>{const{dialogProps:E,room_data:j,type:de}=_,[b,y]=R.useState((j==null?void 0:j.files)||[]),[v,W]=R.useState({userId:"",roomCategory:"",amenitiesId:[],price:"",offerPrice:"",totalNoOfRooms:"",area:"",floor:"",bedSize:""}),{hotels:I,roomCategories:C,amenities:d}=D(i=>i.hotel);console.log("amenities",d);const m=$(),{id:f}=L(),S=se(),x=M();let p=window.location.pathname==="/rooms/create"?!0:window.location.pathname===`/rooms/update/${f}`;const w=te({amenitiesId:ie().min(1,"Select at least one amenity").required("Amenities are required"),price:h().required("Price is required").positive("Price must be a positive number"),offerPrice:h().required("Offer Price is required").positive("Offer Price must be a positive number"),totalNoOfRooms:h().required("Total Number of Rooms is required").positive("Total Number of Rooms must be a positive number"),area:h().required("Area is required").positive("Area must be a positive number"),floor:N().required("Floor is required"),bedSize:N().required("Bed Size is required")});R.useEffect(()=>{const i=async()=>{try{await Promise.all([m(X({page:1,page_size:10})),m(Z({page:1,page_size:10})),!p&&m(V({page:1,page_size:10}))])}catch(r){console.error("Error fetching data:",r)}};f&&m(U(f)).then(r=>{const{data:o}=r.payload;console.log("res",o),W({userId:o==null?void 0:o.userId,roomCategory:o==null?void 0:o.roomCategoryId,amenitiesId:(o==null?void 0:o.amenitiesId)||[],price:(o==null?void 0:o.price)||"",offerPrice:(o==null?void 0:o.offerPrice)||"",totalNoOfRooms:(o==null?void 0:o.totalNoOfRooms)||"",area:(o==null?void 0:o.area.replace("SqFt",""))||"",floor:(o==null?void 0:o.floor)||"",bedSize:(o==null?void 0:o.bedSize)||""}),y(o.files||[])}),i()},[m,f]);const H=i=>{y(i)},k=i=>{y(b.filter(r=>r!==i))};return e.jsxs("div",{children:[e.jsxs(l,{container:!0,justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[e.jsx(ne,{color:"secondary",edge:"start",size:"large","aria-label":"back",onClick:()=>x(p?"/rooms":"/hotel/rooms"),children:e.jsx(ae,{})}),e.jsx(G,{variant:"h2",gutterBottom:!0,children:f?"Edit Hotel Rooms":"Create Hotel Rooms"})]}),e.jsx(ee,{initialValues:v,validationSchema:w,enableReinitialize:!0,onSubmit:i=>{var o;const r=new FormData;r.append("userId",p?S==null?void 0:S._id:(o=i==null?void 0:i.userId)==null?void 0:o._id),r.append("roomCategoryId",i.roomCategory),r.append("price",i.price),r.append("offerPrice",i.offerPrice),r.append("totalNoOfRooms",i.totalNoOfRooms),r.append("area",`${i.area}SqFt`),r.append("floor",i.floor),r.append("bedSize",i.bedSize),i.amenitiesId&&i.amenitiesId.forEach(t=>{r.append("amenitiesId[]",t._id?t._id:t)}),b.length&&b.forEach((t,a)=>{r.append("files[]",t),console.log("File",t)}),f?m(Y({formData:r,id:f})).then(t=>{const{requestStatus:a}=t.meta;a==="fulfilled"&&x(p?"/rooms":"/hotel/rooms")}).catch(t=>{console.error("Error creating room:",t)}):p?m(J(r)).then(t=>{const{requestStatus:a}=t.meta;a==="fulfilled"&&x("/rooms")}).catch(t=>{console.error("Error creating room:",t)}):m(K(r)).then(t=>{const{requestStatus:a}=t.meta;a==="fulfilled"&&x("/hotel/rooms")}).catch(t=>{console.error("Error creating room:",t)}),E.onClose()},children:({setFieldValue:i,values:r,handleChange:o,handleBlur:t,touched:a,errors:n})=>{var z,P,q;return e.jsx(oe,{children:e.jsxs(l,{container:!0,spacing:2,children:[!p&&e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(le,{options:(I==null?void 0:I.hotels)||[],getOptionLabel:s=>s.name||"",id:"hotel-autocomplete",name:"userId",value:r.userId,onChange:(s,c)=>{i("userId",c||null)},renderInput:s=>e.jsx(u,{...s,label:"Hotel Name",error:a.userId&&!!n.userId,helperText:a.userId&&n.userId,color:"secondary",fullWidth:!0})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(A,{fullWidth:!0,error:a.roomCategory&&!!n.roomCategory,color:"secondary",children:[e.jsx(O,{id:"roomCategory-label",children:"Room Category"}),e.jsx(F,{labelId:"roomCategory-label",id:"roomCategory",name:"roomCategory",value:(z=r.roomCategory)==null?void 0:z._id,onChange:s=>{console.log("e",s.target.value),i("roomCategory",s.target.value)},label:"Room Category",children:(P=C==null?void 0:C.categories)==null?void 0:P.map(s=>(console.log("category",s),e.jsx(T,{value:s==null?void 0:s._id,children:e.jsx(B,{primary:s.name})},s._id)))}),a.roomCategory&&n.roomCategory&&e.jsx("div",{style:{color:"red",fontSize:"12px"},children:n.roomCategory})]})}),e.jsx(l,{item:!0,xs:6,md:p?6:12,children:e.jsxs(A,{fullWidth:!0,color:"secondary",children:[e.jsx(O,{id:"amenities-label",children:"Amenities"}),console.log("amenities",r.amenities),e.jsx(F,{labelId:"amenities-label",id:"amenitiesId",name:"amenitiesId",multiple:!0,value:r.amenitiesId,onChange:s=>{i("amenitiesId",s.target.value)},input:e.jsx(Q,{label:"Amenities"}),renderValue:s=>{var c;return(c=d==null?void 0:d.data)==null?void 0:c.filter(g=>s.includes(g._id)).map(g=>g.name).join(", ")},children:(q=d==null?void 0:d.data)==null?void 0:q.map(s=>{var c;return e.jsxs(T,{value:s._id,children:[e.jsx(me,{color:"secondary",checked:(c=r==null?void 0:r.amenitiesId)==null?void 0:c.includes(s._id)}),e.jsx(B,{primary:s.name})]},s._id)})})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(u,{color:"secondary",fullWidth:!0,name:"price",label:"Price",variant:"outlined",type:"number",value:r.price,onChange:o,onBlur:t,error:a.price&&!!n.price,helperText:a.price&&n.price})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(u,{fullWidth:!0,color:"secondary",type:"number",name:"offerPrice",label:"Offer Price",variant:"outlined",value:r.offerPrice,onChange:o,onBlur:t,error:a.offerPrice&&!!n.offerPrice,helperText:a.offerPrice&&n.offerPrice})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(u,{color:"secondary",type:"number",fullWidth:!0,name:"totalNoOfRooms",label:"Total Number of Rooms",variant:"outlined",value:r.totalNoOfRooms,onChange:o,onBlur:t,error:a.totalNoOfRooms&&!!n.totalNoOfRooms,helperText:a.totalNoOfRooms&&n.totalNoOfRooms})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(u,{fullWidth:!0,name:"area",color:"secondary",type:"number",label:"Area",variant:"outlined",value:r.area,onChange:o,onBlur:t,error:a.area&&!!n.area,helperText:a.area&&n.area})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(u,{fullWidth:!0,name:"floor",color:"secondary",type:"number",label:"Floor",variant:"outlined",value:r.floor,onChange:o,onBlur:t,error:a.floor&&!!n.floor,helperText:a.floor&&n.floor})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(u,{fullWidth:!0,color:"secondary",name:"bedSize",label:"Bed Size",variant:"outlined",value:r.bedSize,onChange:o,onBlur:t,error:a.bedSize&&!!n.bedSize,helperText:a.bedSize&&n.bedSize})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(re,{label:"Upload Your Images",files:b,setFiles:H,deleteFile:k,multiple:!0})}),e.jsx(l,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",alignItems:"flex-end",children:e.jsx(ce,{type:"submit",variant:"outlined",color:"secondary",children:"Submit"})})]})})}})]})};export{Pe as default};
