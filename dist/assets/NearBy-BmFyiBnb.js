import{a as Y,r as c,u as G,q as U,R as O,T as g,U as V,j as e,G as h,n as q,B as A,F as _,P as $,V as H}from"./index-nP3sWgOM.js";import{I as J}from"./ImageUpload-B33Abahr.js";import{u as K}from"./formik.esm-Dyqt8FN9.js";import{c as Q,a as b}from"./index.esm-B2q6Cw9c.js";import{T as M,S as w}from"./TextField-Btu36Zmo.js";import{I as P}from"./InputLabel-DaDe49tm.js";import{M as k}from"./MenuItem-vSBr2iRT.js";import{B as W}from"./Button-DYMAArme.js";import{G as X}from"./GetToAction-p5I7uB52.js";import{A as Z}from"./Dialog-D7RuuEns.js";import{S as ee}from"./SearchBar-BByW93zJ.js";import{h as te}from"./moment-G82_0lEo.js";import{l as ie}from"./lodash-CeyOGm4C.js";import{D as ae}from"./DataTable-BAyMAVN6.js";import"./index-CcBqUUtn.js";import"./DialogContent-CAWl_w7U.js";import"./Autocomplete-Cb93hnIo.js";import"./Close-CYbAYMXT.js";import"./Checkbox-CVXqhyuK.js";import"./Skeleton-DY2pMhD5.js";import"./colorManipulator-BTVsESXO.js";import"./useThemeProps-Cp5GSgP0.js";const E=T=>{var D,l,j,y,C,S,I,z,v,i,n,N;const{dialogProps:m,near_by_data:o,edit:x}=T,r=Y(),[p,f]=c.useState([]),{cities:u,loading:F}=G(a=>a.location);c.useEffect(()=>{r(U({page:1,page_size:10}))},[]);const B=a=>{f(a)},s=a=>{f(p.filter(d=>d!==a))},t=K({initialValues:{name:(o==null?void 0:o.name)||"",description:(o==null?void 0:o.description)||"",cityId:((D=o==null?void 0:o.cityId)==null?void 0:D._id)||"",type:(o==null?void 0:o.type)||""},validationSchema:Q({name:b().required("Required"),description:b().required("Required"),cityId:b().required("Required"),type:b().required("Required")}),onSubmit:a=>{const d=new FormData;d.append("name",a.name),d.append("description",a.description),d.append("cityId",a.cityId),d.append("type",a.type),p&&p.map(L=>{d.append("file",L)}),x==="edit"?r(O({formData:d,id:o==null?void 0:o._id})).then(()=>{r(g({page:1,page_size:10}))}):(r(V(d)),then(()=>{r(g({page:1,page_size:10}))})),m==null||m.onClose()}}),R=[{_id:"top_sights",name:"Top Sights"},{_id:"restaurants",name:"Restaurants"},{_id:"comunication",name:"Comunication"}];return e.jsx("div",{children:e.jsxs("form",{onSubmit:t.handleSubmit,children:[e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xs:12,sm:12,children:e.jsx(M,{color:"secondary",fullWidth:!0,id:"name",name:"name",label:"Name",value:(l=t.values)==null?void 0:l.name,onChange:t==null?void 0:t.handleChange,error:((j=t.touched)==null?void 0:j.name)&&!!((y=t.errors)!=null&&y.name),helperText:((C=t.touched)==null?void 0:C.name)&&((S=t.errors)==null?void 0:S.name)})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(q,{fullWidth:!0,error:t.touched.type&&!!t.errors.type,color:"secondary",children:[e.jsx(P,{id:"type-label",children:"Type"}),e.jsx(w,{labelId:"type-label",id:"type",name:"type",value:(I=t.values)==null?void 0:I.type,onChange:t.handleChange,label:"Type",children:R.map(a=>e.jsx(k,{value:a==null?void 0:a._id,children:a==null?void 0:a.name},a._id))}),t.touched.cityId&&t.errors.cityId&&e.jsx("div",{style:{color:"red",fontSize:"12px"},children:t.errors.cityId})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(q,{fullWidth:!0,error:t.touched.cityId&&!!t.errors.cityId,color:"secondary",children:[e.jsx(P,{id:"cityId-label",children:"City"}),e.jsx(w,{labelId:"cityId-label",id:"cityId",name:"cityId",value:(z=t.values)==null?void 0:z.cityId,onChange:t.handleChange,label:"City",children:(v=u==null?void 0:u.cities)==null?void 0:v.map(a=>e.jsx(k,{value:a==null?void 0:a.id,children:a==null?void 0:a.name},a.id))}),t.touched.cityId&&t.errors.cityId&&e.jsx("div",{style:{color:"red",fontSize:"12px"},children:t.errors.cityId})]})}),e.jsx(h,{item:!0,xs:12,sm:12,children:e.jsx(M,{color:"secondary",fullWidth:!0,id:"description",name:"description",label:"Description",multiline:!0,minRows:2,value:(i=t.values)==null?void 0:i.description,onChange:t.handleChange,error:((n=t.touched)==null?void 0:n.description)&&!!((N=t.errors)!=null&&N.description),helperText:t.touched.description&&t.errors.description})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(J,{files:p,setFiles:B,deleteFile:s,multiple:!1})})]}),e.jsx(A,{sx:{display:"flex",justifyContent:"flex-end",marginTop:2},children:e.jsx(W,{type:"submit",variant:"outlined",color:"secondary",size:"medium",children:"Submit"})})]})})},be=()=>{const[T,m]=c.useState(""),[o,x]=c.useState(null),[r,p]=c.useState({open:!1,onClose:()=>p({...r,open:!1})}),[f,u]=c.useState({page:0,pageSize:10}),[F,B]=c.useState(""),{nearBy:s,loading:t,status:R,error:D}=G(i=>i.location),l=Y();c.useEffect(()=>{l(g({page:1,page_size:10}))},[l]);const j=()=>{m("Add NearBy Locations"),x(e.jsx(E,{dialogProps:r})),p({...r,open:!0})},y=i=>{const n=s==null?void 0:s.nearbies.find(N=>N._id===i);m("Update NearBy Locations"),x(e.jsx(E,{dialogProps:r,near_by_data:n,edit:"edit"})),p({...r,open:!0})},C=i=>{i.pageSize==f.pageSize?(l(g({page:i.page+1,page_size:i.pageSize})),u(i)):(l(g({page:i.page,page_size:i.pageSize})),u({page:1,pageSize:i.pageSize}))},S=i=>{l(H({id:i}))},I=[{field:"name",headerName:"Name",flex:1},{field:"cityId",headerName:"City ",flex:1,renderCell:i=>{var n;return(n=i==null?void 0:i.value)==null?void 0:n.name}},{field:"description",headerName:"Description",flex:2},{field:"type",headerName:"Type",flex:1},{field:"createdAt",headerName:"Added Date",flex:1,renderCell:i=>te(i.value).format("DD/MM/YYYY")},{field:"_id",headerName:"Action",flex:1,renderCell:i=>X(i.value,y,S)}],z=c.useCallback(ie.debounce(i=>{l(g({page:1,page_size:10,search:i}))},3e3),[]),v=i=>{const n=i.target.value;B(n),z(n)};return e.jsxs("div",{children:[e.jsx(Z,{title:T,content:o,dialogProps:r}),e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[e.jsx(A,{children:e.jsx(ee,{value:F,onChange:v,placeholder:"Search...",size:"small",color:"secondary"})}),e.jsx(W,{sx:{borderRadius:2},variant:"outlined",color:"secondary",size:"large",onClick:j,startIcon:e.jsx(_,{size:14}),children:"Near by"})]}),e.jsx($,{children:e.jsx(ae,{data:s==null?void 0:s.nearbies,columns:I,getRowId:i=>i._id,loading:t,initialState:{pagination:{paginationModel:{pageSize:10}}},rowCount:s==null?void 0:s.count,paginationMode:"server",onPaginationModelChange:C,pageSizeOptions:[10],disableRowSelectionOnClick:!0})})]})};export{be as default};
