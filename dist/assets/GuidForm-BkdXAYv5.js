import{r as x,u as K,a as E,a0 as G,v as M,q as W,bb as _,j as o,L as k,G as s,a3 as P,B as D,n as $,ar as V,bc as N,bd as z}from"./index-nP3sWgOM.js";import{u as O}from"./formik.esm-Dyqt8FN9.js";import{c as q,a as i,d as U,b as J,g as Y}from"./index.esm-B2q6Cw9c.js";import{A as Q}from"./AutoComplete-OgZ3j4BA.js";import{I as X}from"./ImageUpload-B33Abahr.js";import{I as Z}from"./index-BYu15YCe.js";import{a as ee,I as re}from"./InputLabel-DaDe49tm.js";import{T as n,S as ae}from"./TextField-Btu36Zmo.js";import{M as oe}from"./MenuItem-vSBr2iRT.js";import{C as se}from"./Checkbox-CVXqhyuK.js";import{B as te}from"./Button-DYMAArme.js";import"./Autocomplete-Cb93hnIo.js";import"./Close-CYbAYMXT.js";import"./index-CcBqUUtn.js";const ie=48,ne=8,le={PaperProps:{style:{maxHeight:ie*4.5+ne,width:250}}},b=[{name:"Hindi",isKnow:!1},{name:"English",isKnow:!1},{name:"Rajasthani",isKnow:!1}],Pe=B=>{var I,C;const{dialogProps:H,guid_data:f,edit:de}=B,[T,y]=x.useState(!1),[p,j]=x.useState([]),[S,v]=x.useState({name:"",email:"",password:"",mobile:"",pincode:"",address:"",pricePerHour:"",languages:b,about:"",cityId:""}),{cities:{cities:h}}=K(r=>r.location),u=E(),{id:l}=G(),w=M();x.useEffect(()=>{u(W({page:1,page_size:10})),l&&u(_(l)).then(r=>{console.log(r);const{guide:a}=r.payload;console.log(a),v({name:a.name,email:a.email,password:a.password,mobile:a.mobile,pincode:a.pincode,address:a.address,pricePerHour:a.pricePerHour,languages:b.map(t=>({...t,isKnow:a.languages.some(d=>d.name===t.name&&d.isKnow)})),about:a.about,cityId:a.cityId}),j([a==null?void 0:a.file])})},[u,l]);const L=r=>{j(r)},F=r=>{j(p.filter(a=>a!==r))},A=q({name:i().required("Required"),email:i().email("Invalid email address").required("Required"),password:i().min(6,"Password must be at least 6 characters"),mobile:i().matches(/^\d{10}$/,"Must be a valid 10-digit mobile number").required("Required"),pincode:i().matches(/^[1-9][0-9]{5}$/,"Pincode must be a valid 6-digit number").required("Pincode is required"),address:i().required("Required"),pricePerHour:U().min(0,"Price must be a positive number").required("Required"),languages:J().of(q().shape({name:i().required("Language name is required"),isKnow:Y().required("Language knowledge is required")})).test("at-least-one-language","At least one language must be known",function(r){return r.some(a=>a.isKnow)}),about:i().min(20,"About must be at least 20 characters").required("Required")}),e=O({initialValues:S,enableReinitialize:!0,validationSchema:A,onSubmit:r=>{var t,d,c;y(!0);const a=new FormData;a.append("name",r.name),a.append("email",r.email),a.append("cityId",(t=r==null?void 0:r.cityId)!=null&&t._id?(d=r==null?void 0:r.cityId)==null?void 0:d._id:(c=r==null?void 0:r.cityId)==null?void 0:c.id),a.append("mobile",r.mobile),a.append("password",r.password??null),a.append("address",r.address),a.append("pincode",r.pincode),a.append("pricePerHour",r.pricePerHour),a.append("languages",JSON.stringify(r.languages)),a.append("about",r.about),p.length&&p.forEach((m,g)=>{a.append("file",m)}),l?u(N({formData:a,id:l})).then(m=>{const{requestStatus:g}=m.meta;g==="fulfilled"&&w("/guid"),y(!1)}):u(z(a)).then(m=>{const{requestStatus:g}=m.meta;g==="fulfilled"&&w("/guid"),y(!1)}),H.onClose()}}),R=r=>{const{target:{value:a}}=r,t=typeof a=="string"?a.split(","):a,d=b.map(c=>({...c,isKnow:t.includes(c.name)}));e.setFieldValue("languages",d)};return o.jsxs("div",{children:[T&&o.jsx(k,{}),o.jsxs(s,{container:!0,justifyContent:"space-between",alignItems:"center",children:[o.jsx(ee,{color:"secondary",edge:"start",size:"large","aria-label":"back",onClick:()=>w("/guid"),children:o.jsx(Z,{})}),o.jsx(P,{variant:"h2",gutterBottom:!0,children:l?"Edit Guid":"Create Guid"})]}),o.jsx(D,{component:"form",onSubmit:e.handleSubmit,sx:{mt:3},children:o.jsxs(s,{container:!0,spacing:2,children:[o.jsx(s,{item:!0,xs:12,sm:6,children:o.jsx(n,{fullWidth:!0,id:"name",name:"name",label:"Name",color:"secondary",value:e.values.name,onChange:e.handleChange,error:e.touched.name&&!!e.errors.name,helperText:e.touched.name&&e.errors.name})}),o.jsx(s,{item:!0,xs:12,sm:6,children:o.jsx(n,{fullWidth:!0,id:"email",name:"email",label:"Email",color:"secondary",type:"email",value:e.values.email,onChange:e.handleChange,error:e.touched.email&&!!e.errors.email,helperText:e.touched.email&&e.errors.email})}),o.jsx(s,{item:!0,xs:12,sm:6,children:o.jsx(n,{fullWidth:!0,id:"password",name:"password",label:"Password",color:"secondary",type:"password",value:e.values.password,onChange:e.handleChange,error:e.touched.password&&!!e.errors.password,helperText:e.touched.password&&e.errors.password})}),o.jsx(s,{item:!0,xs:12,sm:6,children:o.jsx(n,{fullWidth:!0,id:"mobile",name:"mobile",label:"Mobile",color:"secondary",inputProps:{maxLength:10,inputMode:"numeric",pattern:"[0-9]*"},value:e.values.mobile,onChange:r=>{const a=r.target.value.replace(/\D/g,"").slice(0,10);e.setFieldValue("mobile",a)},error:e.touched.mobile&&!!e.errors.mobile,helperText:e.touched.mobile&&e.errors.mobile})}),o.jsx(s,{item:!0,xs:12,sm:6,children:o.jsx(n,{fullWidth:!0,id:"pincode",name:"pincode",label:"Pincode",color:"secondary",value:e.values.pincode,onChange:e.handleChange,error:e.touched.pincode&&!!e.errors.pincode,helperText:e.touched.pincode&&e.errors.pincode})}),o.jsx(s,{item:!0,xs:12,sm:6,children:o.jsx(n,{fullWidth:!0,id:"pricePerHour",name:"pricePerHour",label:"Price per Hour",color:"secondary",type:"number",value:e.values.pricePerHour,onChange:e.handleChange,error:e.touched.pricePerHour&&!!e.errors.pricePerHour,helperText:e.touched.pricePerHour&&e.errors.pricePerHour})}),o.jsx(s,{item:!0,xs:12,children:o.jsxs($,{fullWidth:!0,error:e.touched.languages&&!!e.errors.languages,children:[o.jsx(re,{id:"languages-label",children:"Languages"}),o.jsx(ae,{labelId:"languages-label",label:"Languages",id:"languages",color:"secondary",multiple:!0,value:e.values.languages.filter(r=>r.isKnow).map(r=>r.name),onChange:R,renderValue:r=>r.join(", "),MenuProps:le,children:b.map(r=>{var a;return o.jsxs(oe,{value:r.name,children:[o.jsx(se,{checked:((a=e.values.languages.find(t=>t.name===r.name))==null?void 0:a.isKnow)||!1,color:"secondary"}),o.jsx(V,{primary:r.name})]},r.name)})}),e.touched.languages&&e.errors.languages&&o.jsx(P,{color:"error",children:e.errors.languages})]})}),o.jsx(s,{item:!0,xs:12,children:o.jsx(Q,{options:h||[],label:"Select City",id:"state-city",name:"cityId",value:l?(I=h==null?void 0:h.find(r=>{var a;return r._id===((a=f==null?void 0:f.cityId)==null?void 0:a._id)}))==null?void 0:I.name:(C=e==null?void 0:e.values)==null?void 0:C.cityId,onChange:r=>{e.setFieldValue("cityId",r||"")},error:e.touched.cityId&&!!e.errors.cityId,helperText:e.touched.cityId&&e.errors.cityId,required:!0,optionKey:"_id",optionLabel:"name",color:"secondary"})}),o.jsx(s,{item:!0,xs:12,children:o.jsx(n,{fullWidth:!0,id:"about",name:"about",label:"About",color:"secondary",multiline:!0,minRows:3,value:e.values.about,onChange:e.handleChange,error:e.touched.about&&!!e.errors.about,helperText:e.touched.about&&e.errors.about})}),o.jsx(s,{item:!0,xs:12,sm:12,children:o.jsx(n,{fullWidth:!0,id:"address",name:"address",label:"Address",color:"secondary",multiline:!0,minRows:3,value:e.values.address,onChange:e.handleChange,error:e.touched.address&&!!e.errors.address,helperText:e.touched.address&&e.errors.address})}),o.jsx(s,{item:!0,xs:12,children:o.jsx(X,{label:"Upload Your Images",files:p,setFiles:L,deleteFile:F,multiple:!1})}),o.jsx(s,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",marginTop:2},children:o.jsx(te,{color:"secondary",variant:"outlined",type:"submit",children:"Submit"})})]})})]})};export{Pe as default};
