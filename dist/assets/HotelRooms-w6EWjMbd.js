import{c as x,O as _,Q as $,j as e,aj as G,ak as b,al as U,G as d,$ as D,f as q,am as L,ag as Q,ac as J,a8 as K,B as k,a5 as V,W as X,o as Z,an as ee}from"./index-BBlBa7Qk.js";import{F as oe,a as ie}from"./formik.esm-iq-b8xKy.js";import{I as re}from"./ImageUpload-B5CAPUTE.js";import{c as ae,d as te,b as A,a as w}from"./index.esm-CIT1Jkon.js";import{I as F,B as Y}from"./InputLabel-BvzpAYWJ.js";import{S as E,T as C}from"./TextField-CILEcrSZ.js";import{M as W}from"./Skeleton-IcUOLArC.js";import{C as se}from"./Checkbox-CM1tfGSp.js";import{A as ne,D as le,h as de,G as ce}from"./GetToAction-DPWmTIJ3.js";import{l as me}from"./lodash-B-mYtyDl.js";import"./IconButton-D_eKau7j.js";const H=O=>{var P,N;const{dialogProps:R,room_data:o,type:I}=O,[c,y]=x.useState([]),{hotels:S,roomCategories:g,amenities:z}=_(a=>a.hotel),f=$();x.useEffect(()=>{(async()=>{try{await Promise.all([f(Q()),f(J()),f(K())])}catch(i){console.error("Error fetching data:",i)}})()},[f]);const u={userId:((P=o==null?void 0:o.userId)==null?void 0:P.name)||"",roomCategory:((N=o==null?void 0:o.roomCategoryId)==null?void 0:N._id)||"",amenities:(o==null?void 0:o.amenitiesId)||[],price:(o==null?void 0:o.price)||"",offerPrice:(o==null?void 0:o.offerPrice)||"",totalNoOfRooms:(o==null?void 0:o.totalNoOfRooms)||"",area:(o==null?void 0:o.area)||"",floor:(o==null?void 0:o.floor)||"",bedSize:(o==null?void 0:o.bedSize)||""},m=ae({amenities:te().min(1,"Select at least one amenity").required("Amenities are required"),price:A().required("Price is required").positive("Price must be a positive number"),offerPrice:A().required("Offer Price is required").positive("Offer Price must be a positive number"),totalNoOfRooms:A().required("Total Number of Rooms is required").positive("Total Number of Rooms must be a positive number"),area:A().required("Area is required").positive("Area must be a positive number"),floor:w().required("Floor is required"),bedSize:w().required("Bed Size is required")}),B=a=>{y(a)},M=a=>{y(c.filter(i=>i!==a))};return e.jsx("div",{children:e.jsx(oe,{initialValues:u,validationSchema:m,onSubmit:a=>{var p;const i=new FormData;i.append("userId",(p=a==null?void 0:a.userId)==null?void 0:p._id),i.append("roomCategoryId",a.roomCategory._id),i.append("price",a.price),i.append("offerPrice",a.offerPrice),i.append("totalNoOfRooms",a.totalNoOfRooms),i.append("area",`${a.area}SqFt`),i.append("floor",a.floor),i.append("bedSize",a.bedSize),a.amenities&&a.amenities.forEach(l=>{i.append("amenitiesId[]",l._id)}),c.length&&c.forEach((l,s)=>{i.append("files[]",l),console.log("File",l)}),I==="edit"?f(G({formData:i,id:o==null?void 0:o._id})).then(()=>{f(b({page:1,page_size:10}))}).catch(l=>{console.error("Error creating room:",l)}):f(U(i)).then(()=>{f(b({page:1,page_size:10}))}).catch(l=>{console.error("Error creating room:",l)}),R.onClose()},children:({setFieldValue:a,values:i,handleChange:p,handleBlur:l,touched:s,errors:t})=>{var r,h,v;return e.jsx(ie,{children:e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,md:6,children:e.jsxs(D,{fullWidth:!0,error:s.userId&&!!t.userId,color:"secondary",children:[e.jsx(F,{id:"rooms-label",children:"Hotel Name"}),e.jsx(E,{labelId:"hotle-label",id:"rooms-label",name:"userId",value:i.userId,onChange:n=>{const j=S.hotels.find(T=>T._id===n.target.value._id);a("userId",j)},label:"Hotel Name",children:(r=S==null?void 0:S.hotels)==null?void 0:r.map(n=>e.jsx(W,{value:n,children:e.jsx(q,{primary:n.name})},n._id))}),s.userId&&t.userId&&e.jsx("div",{style:{color:"red",fontSize:"12px"},children:t.userId})]})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsxs(D,{fullWidth:!0,error:s.roomCategory&&!!t.roomCategory,color:"secondary",children:[e.jsx(F,{id:"roomCategory-label",children:"Room Category"}),e.jsx(E,{labelId:"roomCategory-label",id:"roomCategory",name:"roomCategory",value:i.roomCategory,onChange:n=>{const j=g.categories.find(T=>T._id===n.target.value._id);a("roomCategory",j)},label:"Room Category",children:(h=g==null?void 0:g.categories)==null?void 0:h.map(n=>e.jsx(W,{value:n,children:e.jsx(q,{primary:n.name})},n._id))}),s.roomCategory&&t.roomCategory&&e.jsx("div",{style:{color:"red",fontSize:"12px"},children:t.roomCategory})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(D,{fullWidth:!0,error:s.amenities&&!!t.amenities,color:"secondary",children:[e.jsx(F,{id:"amenities-label",children:"Amenities"}),e.jsx(E,{labelId:"amenities-label",id:"amenities",name:"amenities",multiple:!0,value:i.amenities,onChange:n=>a("amenities",n.target.value),input:e.jsx(L,{label:"Amenities"}),renderValue:n=>n.map(j=>j.name).join(", "),children:(v=z==null?void 0:z.data)==null?void 0:v.map(n=>e.jsxs(W,{value:n,children:[e.jsx(se,{checked:i.amenities.some(j=>j._id===n._id)}),e.jsx(q,{primary:n.name})]},n._id))}),s.amenities&&t.amenities&&e.jsx("div",{style:{color:"red",fontSize:"12px"},children:t.amenities})]})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(C,{color:"secondary",fullWidth:!0,name:"price",label:"Price",variant:"outlined",value:i.price,onChange:p,onBlur:l,error:s.price&&!!t.price,helperText:s.price&&t.price})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,color:"secondary",name:"offerPrice",label:"Offer Price",variant:"outlined",value:i.offerPrice,onChange:p,onBlur:l,error:s.offerPrice&&!!t.offerPrice,helperText:s.offerPrice&&t.offerPrice})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(C,{color:"secondary",fullWidth:!0,name:"totalNoOfRooms",label:"Total Number of Rooms",variant:"outlined",value:i.totalNoOfRooms,onChange:p,onBlur:l,error:s.totalNoOfRooms&&!!t.totalNoOfRooms,helperText:s.totalNoOfRooms&&t.totalNoOfRooms})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,name:"area",color:"secondary",label:"Area",variant:"outlined",value:i.area,onChange:p,onBlur:l,error:s.area&&!!t.area,helperText:s.area&&t.area})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,name:"floor",color:"secondary",label:"Floor",variant:"outlined",value:i.floor,onChange:p,onBlur:l,error:s.floor&&!!t.floor,helperText:s.floor&&t.floor})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,color:"secondary",name:"bedSize",label:"Bed Size",variant:"outlined",value:i.bedSize,onChange:p,onBlur:l,error:s.bedSize&&!!t.bedSize,helperText:s.bedSize&&t.bedSize})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(re,{label:"Upload Your Images",files:c,setFiles:B,deleteFile:M,multiple:!0})}),e.jsx(d,{item:!0,xs:12,justifyContent:"flex-end",children:e.jsx(Y,{type:"submit",variant:"outlined",color:"secondary",children:"Submit"})})]})})}})})},ze=()=>{var t;const[O,R]=x.useState(""),[o,I]=x.useState(null),[c,y]=x.useState({open:!1,onClose:()=>y({...c,open:!1})}),[S,g]=x.useState({page:0,pageSize:10}),[z,f]=x.useState(""),u=$(),{rooms:m,loading:B,error:M}=_(r=>r.hotel);x.useEffect(()=>{u(b({page:1,page_size:10}))},[u]);const P=()=>{R("Add Rooms"),I(e.jsx(H,{dialogProps:c})),y({...c,open:!0})},N=r=>{const h=m==null?void 0:m.rooms.find(v=>v._id===r);R("Update Rooms"),I(e.jsx(H,{dialogProps:c,room_data:h,type:"edit"})),y({...c,open:!0})},a=r=>{u(ee({id:r})).then(()=>{u(b({page:1,page_size:10}))})},i=[{field:"area",headerName:"Room Size ",flex:1},{field:"bedSize",headerName:"Bed Size ",flex:1},{field:"price",headerName:"Price ",flex:1},{field:"offerPrice",headerName:"OfferPrice ",flex:1},{field:"totalNoOfRooms",headerName:"Number Of Rooms ",flex:1},{field:"createdAt",headerName:"Added Date",flex:1,renderCell:r=>de(r.value).format("DD/MM/YYYY")},{field:"roomCategoryId",headerName:"Room Category",flex:1,renderCell:r=>r.value.name},{field:"_id",headerName:"Action",flex:1,renderCell:r=>ce(r.value,N,a)}],p=r=>{r.pageSize==S.pageSize?(u(b({page:r.page+1,page_size:r.pageSize})),g(r)):(u(b({page:r.page,page_size:r.pageSize})),g({page:1,pageSize:r.pageSize}))},l=x.useCallback(me.debounce(r=>{u(b({page:1,page_size:10,search:r}))},1e3),[]),s=r=>{const h=r.target.value;f(h),l(h)};return e.jsxs("div",{children:[e.jsx(ne,{title:O,content:o,dialogProps:c}),e.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[e.jsx(k,{children:e.jsx(V,{value:z,handleSearchChange:s})}),e.jsx(Y,{sx:{borderRadius:2},variant:"outlined",color:"secondary",size:"large",onClick:P,startIcon:e.jsx(X,{size:14}),children:"Rooms"})]}),e.jsx(Z,{children:e.jsx(le,{data:m==null?void 0:m.rooms,columns:i,getRowId:r=>r._id,loading:B,initialState:{pagination:{paginationModel:{pageSize:10}}},rowCount:(t=m==null?void 0:m.rooms)==null?void 0:t.length,paginationMode:"server",onPaginationModelChange:p,pageSizeOptions:[10],disableRowSelectionOnClick:!0})})]})};export{ze as default};
