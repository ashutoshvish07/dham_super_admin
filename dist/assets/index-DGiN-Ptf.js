import{c,O as q,Q as B,a4 as v,ao as R,ap as x,aq as M,j as a,B as D,G as d,a5 as N,W as E,o as W,ar as Y}from"./index-BaHD66kx.js";import{u as k}from"./formik.esm-KIhpJ1AK.js";import{c as _,a as g}from"./index.esm-VLdIUeus.js";import{A as $}from"./AutoComplete-YiA7Ck6w.js";import{I as O}from"./ImageUpload-CSqTCrZw.js";import{T as f}from"./TextField-CwAoBwYD.js";import{B as F}from"./InputLabel-BZw1JY1B.js";import{A as U,D as V,h as L,G as K}from"./GetToAction-KPhA80I9.js";import{l as Q}from"./lodash-g1Ld88bH.js";import"./IconButton-NUepV84n.js";import"./Skeleton-DmPhDa6e.js";import"./Checkbox-BYXElSFK.js";const G=l=>{var y,S,I;const{dialogProps:t,guid_data:r,edit:j}=l,[p,C]=c.useState([]),{cities:{cities:n}}=q(o=>o.location);console.log("guid_data",r,n),console.log(n==null?void 0:n.find(o=>{var s;return o._id===((s=r==null?void 0:r.cityId)==null?void 0:s._id)}));const u=B();c.useEffect(()=>{u(v())},[]);const A=o=>{C(o)},m=o=>{C(p.filter(s=>s!==o))},b=_({name:g().required("Required"),email:g().email("Invalid email address").required("Required"),password:g().min(6,"Password must be at least 6 characters").required("Required"),mobile:g().matches(/^\d{10}$/,"Must be a valid 10-digit mobile number").required("Required"),pincode:g().matches(/^\d{6}$/,"Must be a valid 6-digit pincode").required("Required"),address:g().required("Required")}),e=k({initialValues:{name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",password:"",mobile:(r==null?void 0:r.mobile)||"",pincode:(r==null?void 0:r.pincode)||"",address:(r==null?void 0:r.address)||"",cityId:((y=r==null?void 0:r.cityId)==null?void 0:y._id)||""},validationSchema:b,onSubmit:o=>{var w,z;const s=new FormData;s.append("name",o.name),s.append("email",o.email),s.append("cityId",(w=o==null?void 0:o.cityId)!=null&&w._id?(z=o==null?void 0:o.cityId)==null?void 0:z._id:o==null?void 0:o.cityId),s.append("mobile",o.mobile),s.append("password",o.password),s.append("address",o.address),s.append("pincode",o.pincode),p&&p.map(T=>{s.append("file",T)}),j?u(R({formData:s,id:r==null?void 0:r._id})).then(()=>{u(x({page:1,page_size:10}))}):u(M(s)).then(()=>{u(x({page:1,page_size:10}))}),t.onClose()}});return a.jsx("div",{children:a.jsx(D,{component:"form",onSubmit:e.handleSubmit,sx:{mt:3},children:a.jsxs(d,{container:!0,spacing:2,children:[a.jsx(d,{item:!0,xs:12,sm:6,children:a.jsx(f,{fullWidth:!0,id:"name",name:"name",label:"Name",color:"secondary",value:e.values.name,onChange:e.handleChange,error:e.touched.name&&!!e.errors.name,helperText:e.touched.name&&e.errors.name})}),a.jsx(d,{item:!0,xs:12,sm:6,children:a.jsx(f,{fullWidth:!0,id:"email",name:"email",label:"Email",color:"secondary",type:"email",value:e.values.email,onChange:e.handleChange,error:e.touched.email&&!!e.errors.email,helperText:e.touched.email&&e.errors.email})}),a.jsx(d,{item:!0,xs:12,sm:6,children:a.jsx(f,{fullWidth:!0,id:"password",name:"password",label:"Password",color:"secondary",type:"password",value:e.values.password,onChange:e.handleChange,error:e.touched.password&&!!e.errors.password,helperText:e.touched.password&&e.errors.password})}),a.jsx(d,{item:!0,xs:12,sm:6,children:a.jsx(f,{fullWidth:!0,color:"secondary",id:"mobile",name:"mobile",label:"Mobile",inputProps:{maxLength:10,inputMode:"numeric",pattern:"[0-9]*"},value:e.values.mobile,onChange:o=>{const s=o.target.value.replace(/\D/g,"").slice(0,10);e.setFieldValue("mobile",s)},error:e.touched.mobile&&!!e.errors.mobile,helperText:e.touched.mobile&&e.errors.mobile})}),a.jsx(d,{item:!0,xs:12,sm:6,children:a.jsx(f,{fullWidth:!0,id:"pincode",name:"pincode",label:"Pincode",color:"secondary",value:e.values.pincode,onChange:e.handleChange,error:e.touched.pincode&&!!e.errors.pincode,helperText:e.touched.pincode&&e.errors.pincode})}),a.jsx(d,{item:!0,xs:12,sm:6,children:a.jsx(f,{fullWidth:!0,id:"address",name:"address",label:"Address",color:"secondary",value:e.values.address,onChange:e.handleChange,error:e.touched.address&&!!e.errors.address,helperText:e.touched.address&&e.errors.address})}),a.jsx(d,{item:!0,xs:12,children:a.jsx($,{options:n||[],label:"Select City",id:"state-city",name:"cityId",value:j?(S=n==null?void 0:n.find(o=>{var s;return o._id===((s=r==null?void 0:r.cityId)==null?void 0:s._id)}))==null?void 0:S.name:(I=e==null?void 0:e.values)==null?void 0:I.cityId,onChange:o=>{e.setFieldValue("cityId",o||"")},error:e.touched.cityId&&!!e.errors.cityId,helperText:e.touched.cityId&&e.errors.cityId,required:!0,optionKey:"_id",optionLabel:"name",color:"secondary"})}),a.jsx(d,{item:!0,xs:12,children:a.jsx(O,{label:"Upload Your Images",files:p,setFiles:A,deleteFile:m,multiple:!1})}),a.jsx(d,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",marginTop:2},children:a.jsx(F,{color:"secondary",variant:"outlined",type:"submit",children:"Submit"})})]})})})},de=()=>{const l=B(),{guids:t,loading:r}=q(i=>i.guid),[j,p]=c.useState(""),[C,n]=c.useState(null),[u,A]=c.useState(""),[m,b]=c.useState({open:!1,onClose:()=>b({...m,open:!1})}),[e,y]=c.useState({page:0,pageSize:10});c.useEffect(()=>{l(x({page:1,page_size:10}))},[l]);const S=()=>{p("Add Guid"),n(a.jsx(G,{dialogProps:m})),b({...m,open:!0})},I=i=>{const h=t==null?void 0:t.guids.find(P=>P._id===i);p("Update Guid"),n(a.jsx(G,{dialogProps:m,guid_data:h,edit:!0})),b({...m,open:!0})},o=i=>{l(Y({id:i})).then(()=>{l(x({page:1,page_size:10}))})},s=c.useCallback(Q.debounce(i=>{l(x({page:e.page+1,page_size:e==null?void 0:e.pageSize,search:i}))},1e3),[]),w=i=>{const h=i.target.value;A(h),s(h)},z=[{field:"name",headerName:"Name",flex:1},{field:"cityId",headerName:"City ",flex:1,renderCell:i=>{var h;return(h=i==null?void 0:i.value)==null?void 0:h.name}},{field:"address",headerName:"Address",flex:2},{field:"email",headerName:"Email",flex:1},{field:"mobile",headerName:"Mobile",flex:1},{field:"status",headerName:"Status",flex:1},{field:"createdAt",headerName:"Added Date",flex:1,renderCell:i=>L(i.value).format("DD/MM/YYYY")},{field:"_id",headerName:"Action",flex:1,renderCell:i=>K(i.value,I,o)}],T=i=>{i.pageSize==e.pageSize?(l(x({page:i.page+1,page_size:i.pageSize})),y(i)):(l(x({page:i.page,page_size:i.pageSize})),y({page:1,pageSize:i.pageSize}))};return a.jsxs("div",{children:[a.jsx(U,{title:j,content:C,dialogProps:m}),a.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[a.jsx(D,{children:a.jsx(N,{value:u,handleSearchChange:w})}),a.jsx(F,{sx:{borderRadius:2},variant:"outlined",color:"secondary",size:"large",onClick:S,startIcon:a.jsx(E,{size:14}),children:"Guid"})]}),a.jsx(W,{children:a.jsx(V,{data:t==null?void 0:t.guids,columns:z,getRowId:i=>i._id,loading:r,initialState:{pagination:{paginationModel:{pageSize:10}}},rowCount:t==null?void 0:t.count,paginationMode:"server",onPaginationModelChange:T,pageSizeOptions:[10],disableRowSelectionOnClick:!0})})]})};export{de as default};
