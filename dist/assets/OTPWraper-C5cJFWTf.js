import{a9 as Y,aJ as I,j as r,B as M,am as Z,a as _,v as ee,u as te,r as W,bl as re,n as q,aq as ne,bi as ae,an as se,G as y,bj as ie,bk as oe,b5 as le,a3 as H}from"./index-nP3sWgOM.js";import{A as ce,a as ue}from"./AuthCardWrapper-BAHu84p1.js";import{c as me,a as N}from"./index.esm-B2q6Cw9c.js";import{F as de}from"./formik.esm-Dyqt8FN9.js";import{T as pe}from"./TextField-Btu36Zmo.js";import{C as he}from"./CustomSnackBar-eieN8mYK.js";import{I as fe,F as E}from"./InputLabel-DaDe49tm.js";import{B as xe}from"./Button-DYMAArme.js";import"./Close-CYbAYMXT.js";const ge=Y(pe)`
  input {
    text-align: center;
  }
`,ye={TextFieldStyled:ge},je=n=>r.jsx(ye.TextFieldStyled,{...n}),R={left:"ArrowLeft",right:"ArrowRight",backspace:"Backspace",home:"Home",end:"End"};function ve(n,s){return n<=0?[]:Array.from({length:n},s)}function be(n,s,f){return n.map((u,k)=>s===k?f:u)}function $(n){return n.join("")}function G(n,s){return[...n,s]}function we(n,s,f){return n.reduce((u,k,m)=>{const{characters:x,restArrayMerged:d}=u;if(m<f)return{restArrayMerged:d,characters:G(x,k)};const[C,...B]=d;return{restArrayMerged:B,characters:G(x,C||"")}},{restArrayMerged:s,characters:[]}).characters}function Ce(n){return n.split("")}function K(n){const s=I.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return I.useInsertionEffect(()=>{s.current=n}),I.useCallback((...f)=>{var u;return(u=s.current)==null?void 0:u.call(s,...f)},[])}const Fe=()=>!0,ke=I.forwardRef((n,s)=>{const{value:f="",length:u=4,autoFocus:k=!1,onChange:m,TextFieldsProps:x,onComplete:d,validateChar:C=Fe,className:B,onBlur:l,...A}=n,T=I.useRef(f),j=K(d),g=K(e=>{const t=e.slice(0,u);return{isCompleted:t.length===u,finalValue:t}});I.useEffect(()=>{const{isCompleted:e,finalValue:t}=g(T.current);e&&j(t)},[u,j,g]);const c=ve(u,(e,t)=>({character:f[t]||"",inputRef:I.createRef()})),F=e=>c.findIndex(({inputRef:t})=>t.current===e),O=()=>c.map(({character:e})=>e),P=(e,t)=>{const a=be(O(),e,t);return $(a)},z=e=>{var t,a;(a=(t=c[e])==null?void 0:t.inputRef.current)==null||a.focus()},h=e=>{var t,a;(a=(t=c[e])==null?void 0:t.inputRef.current)==null||a.select()},V=e=>{e+1!==u&&(c[e+1].character?h(e+1):z(e+1))},L=(e,t)=>typeof C!="function"?!0:C(e,t),J=e=>{const t=F(e.target);if(t===0&&e.target.value.length>1){const{finalValue:w,isCompleted:D}=g(e.target.value);m==null||m(w),D&&(d==null||d(w)),h(w.length-1);return}const a=e.target.value[0]||"";let p=a;p&&!L(p,t)&&(p="");const i=P(t,p);m==null||m(i);const{isCompleted:b,finalValue:v}=g(i);b&&(d==null||d(v)),p!==""?i.length-1<t?h(i.length):V(t):a===""&&i.length<=t&&h(t-1)},Q=e=>{const t=e.target,a=t.selectionStart,p=t.selectionEnd,i=F(t),b=a===0&&p===0;if(t.value===e.key)e.preventDefault(),V(i);else if(R.backspace===e.key){if(!t.value)e.preventDefault(),h(i-1);else if(b){e.preventDefault();const v=P(i,"");m==null||m(v),v.length<=i&&h(i-1)}}else R.left===e.key?(e.preventDefault(),h(i-1)):R.right===e.key?(e.preventDefault(),h(i+1)):R.home===e.key?(e.preventDefault(),h(0)):R.end===e.key&&(e.preventDefault(),h(c.length-1))},U=e=>{const t=e.clipboardData.getData("text/plain"),a=e.target,p=c.findIndex(({character:o,inputRef:S})=>o===""||S.current===a),i=O(),b=we(i,Ce(t),p).map((o,S)=>L(o,S)?o:""),v=$(b);m==null||m(v);const{isCompleted:w,finalValue:D}=g(v);w?(d==null||d(D),h(u-1)):h(v.length)},X=e=>{if(!c.some(({inputRef:t})=>t.current===e.relatedTarget)){const{isCompleted:t,finalValue:a}=g(f);l==null||l(a,t)}};return r.jsx(M,{display:"flex",gap:"20px",alignItems:"center",ref:s,className:`MuiOtpInput-Box ${B||""}`,...A,children:c.map(({character:e,inputRef:t},a)=>{const{onPaste:p,onFocus:i,onKeyDown:b,className:v,onBlur:w,...D}=typeof x=="function"?x(a)||{}:x||{};return r.jsx(je,{autoFocus:k?a===0:!1,autoComplete:"one-time-code",value:e,inputRef:t,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${a+1} ${v||""}`,onPaste:o=>{o.preventDefault(),U(o),p==null||p(o)},onFocus:o=>{o.preventDefault(),o.target.select(),i==null||i(o)},onChange:J,onKeyDown:o=>{Q(o),b==null||b(o)},onBlur:o=>{w==null||w(o),X(o)},...D},a)})})}),Ae=({...n})=>{const s=Z(),f=_(),u=ee(),k=te(l=>l.auth.email),[m,x]=W.useState(!1),[d,C]=W.useState({message:"",severity:"success"}),B=()=>{x(!1)};return r.jsxs("div",{children:[r.jsx(he,{open:m,message:d.message,severity:d.severity,onClose:B}),r.jsx(de,{initialValues:{email:k,otp:""},validationSchema:me().shape({email:N().email("Must be a valid email").max(255).required("Email is required"),otp:N().length(6,"OTP must be 6 digits").required("OTP is required")}),onSubmit:(l,{setSubmitting:A,setErrors:T})=>{f(re({email:l.email,otp:l.otp})).then(j=>{var c,F;const g=(F=(c=j.payload)==null?void 0:c.user)==null?void 0:F.role;j.payload.success&&g.toLowerCase()=="admin"?(u("/dashboard/default"),C({message:"Log in successfully!",severity:"success"}),x(!0)):j.payload.success&&g.toLowerCase()=="hotel"?u("/dashboard/hotel-admin"):(C({message:"Invalid Otp",severity:"error"}),x(!0)),A(!1)}).catch(j=>{T({submit:j.message}),C({message:"There was an error processing your request.",severity:"error"}),x(!0),A(!1)})},children:({errors:l,handleBlur:A,handleChange:T,handleSubmit:j,isSubmitting:g,touched:c,values:F})=>r.jsxs("form",{noValidate:!0,onSubmit:j,...n,children:[r.jsxs(q,{fullWidth:!0,error:!!(c.email&&l.email),sx:{...s.typography.customInput},children:[r.jsx(fe,{htmlFor:"outlined-adornment-email-login",children:"Email Address"}),r.jsx(ne,{id:"outlined-adornment-email-login",type:"email",value:F.email,name:"email",onBlur:A,onChange:T,label:"Email Address ",inputProps:{}}),c.email&&l.email&&r.jsx(E,{error:!0,id:"standard-weight-helper-text-email-login",children:l.email})]}),r.jsxs(q,{fullWidth:!0,error:!!(c.password&&l.password),sx:{...s.typography.customInput},children:[r.jsx(ke,{name:"otp",autoFocus:!0,sx:{gap:{xs:"2px",sm:"12px",md:"20px",lg:"24px"}},value:F.otp,onChange:O=>{T({target:{name:"otp",value:O}})},onBlur:A,length:6}),c.password&&l.password&&r.jsx(E,{error:!0,id:"standard-weight-helper-text-password-login",children:l.password})]}),l.submit&&r.jsx(M,{sx:{mt:3},children:r.jsx(E,{error:!0,children:l.submit})}),r.jsx(M,{sx:{mt:2},children:r.jsx(ae,{children:r.jsx(xe,{disableElevation:!0,disabled:g,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"secondary",children:"Sign in"})})})]})})]})},Pe=()=>{const n=se(s=>s.breakpoints.down("md"));return r.jsx(ce,{children:r.jsxs(y,{container:!0,direction:"column",justifyContent:"flex-end",sx:{minHeight:"100vh"},children:[r.jsx(y,{item:!0,xs:12,children:r.jsx(y,{container:!0,justifyContent:"center",alignItems:"center",sx:{minHeight:"calc(100vh - 68px)"},children:r.jsx(y,{item:!0,sx:{m:{xs:1,sm:3},mb:0},children:r.jsx(ue,{children:r.jsxs(y,{container:!0,spacing:2,alignItems:"center",justifyContent:"center",children:[r.jsx(y,{item:!0,sx:{mb:3},children:r.jsx(ie,{to:"#","aria-label":"logo",children:r.jsx(oe,{})})}),r.jsx(y,{item:!0,xs:12,children:r.jsx(y,{container:!0,direction:{xs:"column-reverse",md:"row"},alignItems:"center",justifyContent:"center",children:r.jsx(y,{item:!0,children:r.jsxs(le,{alignItems:"center",justifyContent:"center",spacing:1,children:[r.jsx(H,{color:"secondary.main",gutterBottom:!0,variant:n?"h3":"h2",children:"Hi, Welcome Back"}),r.jsx(H,{variant:"caption",fontSize:"16px",textAlign:{xs:"center",md:"inherit"},children:"Enter your One Time Password"})]})})})}),r.jsx(y,{item:!0,xs:12,children:r.jsx(Ae,{})})]})})})})}),r.jsx(y,{item:!0,xs:12,sx:{m:3,mt:1}})]})})};export{Pe as default};
