import{r,a as z,j as t,B as m,D as P,E as p,H as _,u as I,S as U,F as k,P as B,I as M}from"./index-nP3sWgOM.js";import{F as R,a as E,b as N}from"./formik.esm-Dyqt8FN9.js";import{T as Y}from"./TextField-Btu36Zmo.js";import{B as S}from"./Button-DYMAArme.js";import{G as O}from"./GetToAction-p5I7uB52.js";import{A as G}from"./Dialog-D7RuuEns.js";import{l as L}from"./lodash-CeyOGm4C.js";import{h as H}from"./moment-G82_0lEo.js";import{D as V}from"./DataTable-BAyMAVN6.js";import"./InputLabel-DaDe49tm.js";import"./MenuItem-vSBr2iRT.js";import"./index-CcBqUUtn.js";import"./DialogContent-CAWl_w7U.js";import"./Autocomplete-Cb93hnIo.js";import"./Close-CYbAYMXT.js";import"./Checkbox-CVXqhyuK.js";import"./Skeleton-DY2pMhD5.js";import"./colorManipulator-BTVsESXO.js";import"./useThemeProps-Cp5GSgP0.js";const A=u=>{var f;const{aminity_data:n,type:j}=u,[g,o]=r.useState(((f=n==null?void 0:n.file)==null?void 0:f.Url)||null),l=z(),d=s=>{const i=s.currentTarget.files[0];o(URL.createObjectURL(i))},h=(s,{setSubmitting:i})=>{const a=new FormData;a.append("name",s.name),s.image&&a.append("file",s.image),j==="edit"?l(P({id:n._id,formData:a})).then(()=>{l(p({page:1,page_size:10}))}):l(_(a)).then(()=>{l(p({page:1,page_size:10}))}),u.dialogProps.onClose(),i(!1)};return t.jsx(R,{initialValues:{name:(n==null?void 0:n.name)||"",file:null},onSubmit:h,children:({setFieldValue:s})=>t.jsxs(E,{children:[t.jsx(m,{mb:2,children:t.jsx(N,{name:"name",children:({field:i})=>t.jsx(Y,{...i,label:"Name",variant:"outlined",fullWidth:!0,color:"secondary"})})}),t.jsx(m,{mb:2,children:t.jsxs(S,{variant:"contained",component:"label",color:"secondary",children:["Upload Image",t.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:i=>{d(i),s("image",i.currentTarget.files[0])}})]})}),g&&t.jsx(m,{mb:2,children:t.jsx("img",{src:g,alt:"Preview",width:"100"})}),t.jsx(m,{sx:{display:"flex",justifyContent:"flex-end",marginTop:2},children:t.jsx(S,{type:"submit",variant:"outlined",color:"secondary",size:"medium",children:"Submit"})})]})})},me=()=>{const[u,n]=r.useState(""),[j,g]=r.useState(null),[o,l]=r.useState({open:!1,onClose:()=>l({...o,open:!1})}),[d,h]=r.useState({page:0,pageSize:10}),[f,s]=r.useState(""),i=z(),{amenities:a,loading:b,error:W}=I(e=>e.hotel);r.useEffect(()=>{i(p({page:1,page_size:10}))},[i]);const C=()=>{n("Add Amenities"),g(t.jsx(A,{dialogProps:o})),l({...o,open:!0})},y=e=>{const c=a==null?void 0:a.data.find(x=>x._id===e);n("Update Amenities"),g(t.jsx(A,{dialogProps:o,aminity_data:c,type:"edit"})),l({...o,open:!0})},D=e=>{i(M({id:e})).then(()=>{i(p({page:1,page_size:10}))})},v=[{field:"file",headerName:"Media",width:200,renderCell:e=>{var c,x;return t.jsx("img",{alt:(c=e==null?void 0:e.value)==null?void 0:c.Bucket,src:(x=e==null?void 0:e.value)==null?void 0:x.Url,height:50,width:50,style:{objectFit:"contain"}})}},{field:"name",headerName:"Aminities ",flex:2},{field:"createdAt",headerName:"Added Date",flex:2,renderCell:e=>H(e.value).format("DD/MM/YYYY")},{field:"_id",headerName:"Action",flex:2,renderCell:e=>O(e.value,y,D)}],T=e=>{e.pageSize==d.pageSize?(i(p({page:e.page+1,page_size:e.pageSize})),h(e)):(i(p({page:e.page,page_size:e.pageSize})),h({page:1,pageSize:e.pageSize}))},w=r.useCallback(L.debounce(e=>{i(p({page:d.page+1,page_size:d==null?void 0:d.pageSize,search:e}))},1e3),[]),F=e=>{const c=e.target.value;s(c),w(c)};return t.jsxs("div",{children:[t.jsx(G,{title:u,content:j,dialogProps:o}),t.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[t.jsx(m,{children:t.jsx(U,{value:f,handleSearchChange:F})}),t.jsx(S,{sx:{borderRadius:2},variant:"outlined",color:"secondary",size:"large",onClick:C,startIcon:t.jsx(k,{size:14}),children:"Amenities"})]}),t.jsx(B,{children:t.jsx(V,{data:a.data,columns:v,getRowId:e=>e._id,loading:b,initialState:{pagination:{paginationModel:{pageSize:10}}},rowCount:a==null?void 0:a.count,paginationMode:"server",onPaginationModelChange:T,pageSizeOptions:[10],disableRowSelectionOnClick:!0})})]})};export{me as default};
